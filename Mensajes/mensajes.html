<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mensajes - CesConect</title>
    <link rel="stylesheet" href="./styles/mensajes.css">
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="logo">
                <img src="\Red_Social\images\logo.png" alt="CesConect Logo" class="logo-img">
                <h1>CesConect</h1>
            </div>
            <ul class="nav-menu">
                <button onclick="location.href='../index.html'">
                    Inicio</button>
                <button onclick="location.href='../Perfil/perfil.html'">
                    Perfil</button>
                <button onclick="location.href='../Mensajes/mensajes.html'"> Mensajes</button>
                <button onclick="location.href='../Notificaciones/notificaciones.html'"> Notificaciones</button>
                <button onclick="location.href='../Configuracion/configuracion.html'"> Configuración</button>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Mensajes</h2>
                <input type="text" class="search-box" placeholder="Buscar contactos...">
            </div>
            
            <div class="contact-list">
                <ul>
                    <li class="contact-item active" data-contact="Carlos-de-los-Santos">
                        <div class="contact-avatar">A1</div>
                        <div class="contact-info">
                            <div class="contact-name">Carlos-de-los-Santos</div>
                            <div class="contact-last-message">¿Qué has estado haciendo últimamente?</div>
                        </div>
                        <div class="contact-time">10:02</div>
                    </li>
                    
                    <li class="contact-item" data-contact="Hugo.Lucio">
                        <div class="contact-avatar">C2</div>
                        <div class="contact-info">
                            <div class="contact-name">Hugo Lucio</div>
                            <div class="contact-last-message">Perfecto, nos vemos entonces</div>
                        </div>
                        <div class="contact-time">Ayer</div>
                        <div class="unread-badge">2</div>
                    </li>
                    
                    <li class="contact-item" data-contact="Tony_Huerta">
                        <div class="contact-avatar">M3</div>
                        <div class="contact-info">
                            <div class="contact-name">Tony Huerta</div>
                            <div class="contact-last-message">¡Gracias por tu ayuda!</div>
                        </div>
                        <div class="contact-time">Mar</div>
                    </li>
                    
                    <li class="contact-item" data-contact="Wellington_Alvarez">
                        <div class="contact-avatar">J4</div>
                        <div class="contact-info">
                            <div class="contact-name">Wellington Álvarez</div>
                            <div class="contact-last-message">El proyecto está avanzando bien</div>
                        </div>
                        <div class="contact-time">Lun</div>
                        <div class="unread-badge">1</div>
                    </li>
                </ul>
            </div>
        </div>

        <div class="chat-window">
            <div class="chat-header">
                <div class="chat-user-info">
                    <div class="contact-avatar">A1</div>
                    <div>
                        <div class="chat-user-name">Carlos-de-los-Santos</div>
                        <div class="chat-status">En línea</div>
                    </div>
                </div>
            </div>

            <div class="messages" id="messagesContainer">
                <div class="message received">
                    <div class="message-bubble">
                        <p>Hola, ¿cómo estás?</p>
                    </div>
                    <span class="timestamp">10:00 AM</span>
                </div>
                
                <div class="message sent">
                    <div class="message-bubble">
                        <p>¡Hola! Estoy bien, gracias. ¿Y tú?</p>
                    </div>
                    <span class="timestamp">10:01 AM</span>
                </div>
                
                <div class="message received">
                    <div class="message-bubble">
                        <p>También estoy bien. ¿Qué has estado haciendo últimamente?</p>
                    </div>
                    <span class="timestamp">10:02 AM</span>
                </div>

                <div class="message sent">
                    <div class="message-bubble">
                        <p>He estado trabajando en algunos proyectos interesantes. ¡Te contaré más detalles pronto!</p>
                    </div>
                    <span class="timestamp">10:03 AM</span>
                </div>
            </div>

            <div class="input-area">
                <input type="text" id="messageInput" placeholder="Escribe un mensaje...">
                <button class="send-button" id="sendButton">➤</button>
            </div>
        </div>
    </div>

    <script>
        // Referencias a elementos del DOM
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const messagesContainer = document.getElementById('messagesContainer');
        const contactItems = document.querySelectorAll('.contact-item');
        const searchBox = document.querySelector('.search-box');

        // Datos de ejemplo para diferentes contactos
        const chatData = {
            usuario1: {
                name: "Carlos-de-los-Santos",
                avatar: "A1",
                status: "En línea",
                messages: [
                    {type: 'received', text: 'Hola, ¿cómo estás?', time: '10:00 AM'},
                    {type: 'sent', text: '¡Hola! Estoy bien, gracias. ¿Y tú?', time: '10:01 AM'},
                    {type: 'received', text: 'También estoy bien. ¿Qué has estado haciendo últimamente?', time: '10:02 AM'},
                    {type: 'sent', text: 'He estado trabajando en algunos proyectos interesantes. ¡Te contaré más detalles pronto!', time: '10:03 AM'}
                ]
            },
            usuario2: {
                name: "Hugo Lucio",
                avatar: "C2",
                status: "En línea",
                messages: [
                    {type: 'received', text: '¿Vienes a la reunión de mañana?', time: 'Ayer'},
                    {type: 'sent', text: 'Sí, estaré ahí a las 3 PM', time: 'Ayer'},
                    {type: 'received', text: 'Perfecto, nos vemos entonces', time: 'Ayer'}
                ]
            },
            usuario3: {
                name: "Tony Huerta",
                avatar: "M3",
                status: "Desconectada",
                messages: [
                    {type: 'sent', text: 'Te envié los documentos que necesitabas', time: 'Mar'},
                    {type: 'received', text: '¡Gracias por tu ayuda!', time: 'Mar'}
                ]
            },
            usuario4: {
                name: "Wellington Álvarez",
                avatar: "J4",
                status: "En línea",
                messages: [
                    {type: 'received', text: 'El proyecto está avanzando bien', time: 'Lun'},
                    {type: 'sent', text: 'Excelente, manténme informado', time: 'Lun'}
                ]
            }
        };

        let currentContact = 'usuario1';

        // Función para enviar mensaje
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text) return;

            // Crear elemento del mensaje
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message sent';
            
            const now = new Date();
            const timeString = now.toLocaleTimeString('es-ES', {hour: '2-digit', minute: '2-digit'});
            
            messageDiv.innerHTML = `
                <div class="message-bubble">
                    <p>${text}</p>
                </div>
                <span class="timestamp">${timeString}</span>
            `;

            // Añadir mensaje al contenedor
            messagesContainer.appendChild(messageDiv);
            
            // Limpiar input
            messageInput.value = '';
            
            // Scroll al final
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Simular respuesta automática después de 2 segundos
            setTimeout(() => {
                const responses = [
                    "¡Interesante!",
                    "Me parece bien",
                    "¿En serio?",
                    "Cuéntame más",
                    "Perfecto",
                    "¡Genial!",
                    "Entiendo"
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                
                const responseDiv = document.createElement('div');
                responseDiv.className = 'message received';
                responseDiv.innerHTML = `
                    <div class="message-bubble">
                        <p>${randomResponse}</p>
                    </div>
                    <span class="timestamp">${timeString}</span>
                `;
                
                messagesContainer.appendChild(responseDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 2000);
        }

        // Event listeners
        sendButton.addEventListener('click', sendMessage);

        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Cambiar entre contactos
        contactItems.forEach(item => {
            item.addEventListener('click', function() {
                // Remover clase active de todos los contactos
                contactItems.forEach(c => c.classList.remove('active'));
                
                // Añadir clase active al contacto seleccionado
                this.classList.add('active');
                
                // Obtener ID del contacto
                const contactId = this.dataset.contact;
                currentContact = contactId;
                
                // Actualizar chat header
                const chatData_contact = chatData[contactId];
                document.querySelector('.chat-user-name').textContent = chatData_contact.name;
                document.querySelector('.chat-status').textContent = chatData_contact.status;
                document.querySelector('.chat-header .contact-avatar').textContent = chatData_contact.avatar;
                
                // Actualizar mensajes
                loadMessages(contactId);
                
                // Remover badge de no leído
                const badge = this.querySelector('.unread-badge');
                if (badge) {
                    badge.remove();
                }
            });
        });

        // Cargar mensajes de un contacto
        function loadMessages(contactId) {
            const contact = chatData[contactId];
            messagesContainer.innerHTML = '';
            
            contact.messages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${msg.type}`;
                messageDiv.innerHTML = `
                    <div class="message-bubble">
                        <p>${msg.text}</p>
                    </div>
                    <span class="timestamp">${msg.time}</span>
                `;
                messagesContainer.appendChild(messageDiv);
            });
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Búsqueda de contactos
        searchBox.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            
            contactItems.forEach(item => {
                const name = item.querySelector('.contact-name').textContent.toLowerCase();
                if (name.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        });

        // Auto-scroll al final al cargar
        window.addEventListener('load', () => {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        });
    </script>
</body>
</html>